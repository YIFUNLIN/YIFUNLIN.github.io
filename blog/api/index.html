<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <title>林羿帆-個人網站</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="目前在LINE Taiwan 擔任 Backend Engineer Intern">
  <meta name="author" content="Evan Lin">
    
  
  <meta name="theme-name" content="liva-hugo" />
  
  <meta name="generator" content="Hugo 0.148.1">

  <!-- plugins -->
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/venobox/venobox.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="http://localhost:1313/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="http://localhost:1313/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="http://localhost:1313/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
  </script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-K2QY5YMF2Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K2QY5YMF2Z');
</script>

</head>
<body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="http://localhost:1313/">
          
































  

  
  


  


        </a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.instagram.com/yifan00802/"><i class="ti-instagram"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/YIFUNLIN"><i class="ti-github"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/lin-yi-fan-293082257/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="http://localhost:1313/">
            
































  

  
  


  


          </a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/about/">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/blog/">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/contact/">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="http://localhost:1313//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        
        <h2></h2>
        <div class="mb-3 post-meta">
          <span>By Evan Lin</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>01 January 0001</span>
          
        </div>
        
        <div class="content mb-5">
          <p>好的，這就為您調整好，並將標籤與分類的格式修正為 Hugo 能夠正確識別的陣列格式，同時移除多餘的 <code>post thumb</code>, <code>taxonomies</code>, <code>post type</code> 標籤，讓結構更簡潔正確。</p>
<hr>
<p>title: &ldquo;API 深度解析：從核心概念到 Spring Boot 實戰&rdquo;
date: 2025-08-05T22:45:00+08:00
draft: false</p>
<h1 id="meta-description">meta description</h1>
<p>description: &ldquo;這是一份關於 API 的深度解析文章，從核心概念、主流架構 (REST, GraphQL, gRPC) 到安全機制，並包含一份完整的 Spring Boot 與 Kotlin 實戰教學。&rdquo;</p>
<h1 id="type">type</h1>
<p>type : &ldquo;blog&rdquo;</p>
<p>categories:</p>
<ul>
<li>&ldquo;技術學習&rdquo;</li>
<li>&ldquo;後端開發&rdquo;
tags:</li>
<li>&ldquo;API&rdquo;</li>
<li>&ldquo;REST&rdquo;</li>
<li>&ldquo;Spring Boot&rdquo;</li>
<li>&ldquo;Kotlin&rdquo;</li>
<li>&ldquo;後端開發&rdquo;</li>
<li>&ldquo;GraphQL&rdquo;</li>
</ul>
<hr>
<p>嗨，今天要分享的是我先前整理的 API 深度解析文章，從核心概念講起，深入到不同的架構風格、安全性、設計實務，並以 <strong>Spring Boot</strong> 和 <strong>Kotlin</strong> 為例，提供一份從零開始建構與呼叫 API 的完整實戰指南，希望能幫助大家更系統性地理解 API。</p>
<h2 id="一api-到底是什麼">一、API 到底是什麼？</h2>
<p>想像一下您在餐廳用餐的場景：</p>
<ul>
<li><strong>您 (Client)</strong>：想要點一份牛排。</li>
<li><strong>廚房 (Server)</strong>：負責烹飪牛排。</li>
<li><strong>服務生 (API)</strong>：您將需求告訴服務生，服務生將訂單傳達給廚房，最後再將烹飪好的牛排送到您的餐桌上。</li>
</ul>
<p>在這個比喻中，您不需要知道廚房的內部運作（如何採購、烹飪），只需要透過「服務生」這個標準化的介面來取得您想要的「服務」（牛排）。</p>
<p><strong>API</strong> 正是軟體世界中的「服務生」。它定義了不同軟體元件之間如何溝通、交換資料的規則與協定，讓開發者可以取用他人開發好的功能，而無需關心其內部複雜的實作細節。</p>
<hr>
<h2 id="二web-api-的核心解剖">二、Web API 的核心解剖</h2>
<p>當我們談論 API 時，通常指的是基於網路 HTTP 協定的 Web API。一個 API 請求的完整 URL，是由 <strong>Base URL</strong> 和 <strong>Endpoint</strong> 組成。</p>
<p><code>https://api.line.me/v2/bot/message/reply</code></p>
<p><code>__________________/ \___________________/</code>
<code>Base URL</code>              <code>Endpoint</code></p>
<p>但一個完整的 API 互動，還包含以下幾個關鍵部分：</p>
<h3 id="1-http-方法-methods">1. HTTP 方法 (Methods)</h3>
<p>HTTP 方法定義了您想對資源執行的「動作」。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">方法</th>
          <th style="text-align: left">用途</th>
          <th style="text-align: left">特性</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>GET</strong></td>
          <td style="text-align: left">讀取資源。</td>
          <td style="text-align: left">安全、冪等 (Idempotent)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>POST</strong></td>
          <td style="text-align: left">新增資源。</td>
          <td style="text-align: left">非冪等</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>PUT</strong></td>
          <td style="text-align: left">完整取代一個已存在的資源。</td>
          <td style="text-align: left">冪等</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>PATCH</strong></td>
          <td style="text-align: left">部分更新一個已存在的資源。</td>
          <td style="text-align: left">通常非冪等</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>DELETE</strong></td>
          <td style="text-align: left">刪除一個資源。</td>
          <td style="text-align: left">冪等</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p><strong>冪等性 (Idempotency)</strong>：指一次與多次請求對資源產生的影響是相同的。例如，重複呼叫 DELETE 同一個資源，結果都是「資源不存在」，狀態一致。</p></blockquote>
<h3 id="2-標頭-headers">2. 標頭 (Headers)</h3>
<p>Headers 攜帶了請求或回應的元數據 (Metadata)，是一些描述性的鍵值對。</p>
<ul>
<li><strong>請求標頭 (Request Headers)</strong>
<ul>
<li><code>Content-Type</code>: 告訴伺服器，我送出的請求主體是什麼格式 (例如 <code>application/json</code>)。</li>
<li><code>Authorization</code>: 攜帶身份驗證資訊，如 <code>Bearer &lt;token&gt;</code> 或 <code>API-Key &lt;key&gt;</code>。</li>
<li><code>Accept</code>: 告訴伺服器，我期望接收什麼格式的回應。</li>
</ul>
</li>
<li><strong>回應標頭 (Response Headers)</strong>
<ul>
<li><code>Content-Type</code>: 告訴客戶端，我回傳的資料是什麼格式。</li>
<li><code>Cache-Control</code>: 指示客戶端或代理伺服器如何快取此回應。</li>
<li><code>RateLimit-Remaining</code>: 告知客戶端在當前時間窗口內還剩下多少次請求額度。</li>
</ul>
</li>
</ul>
<h3 id="3-主體-body--payload">3. 主體 (Body / Payload)</h3>
<p>對於 <code>POST</code>, <code>PUT</code>, <code>PATCH</code> 這類需要傳遞資料的請求，資料會被放在請求主體中。同理，伺服器的回應資料也通常放在回應主體中。<strong>JSON</strong> 是現今最普及的資料格式。</p>
<h3 id="4-狀態碼-status-codes">4. 狀態碼 (Status Codes)</h3>
<p>伺服器用來告知客戶端請求結果的標準代碼。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">範圍</th>
          <th style="text-align: left">類別</th>
          <th style="text-align: left">常見代碼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>2xx</strong></td>
          <td style="text-align: left">成功 (Success)</td>
          <td style="text-align: left">200 OK, 201 Created, 204 No Content</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>3xx</strong></td>
          <td style="text-align: left">重新導向 (Redirection)</td>
          <td style="text-align: left">301 Moved Permanently, 302 Found</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>4xx</strong></td>
          <td style="text-align: left">客戶端錯誤 (Client Error)</td>
          <td style="text-align: left">400 Bad Request, 401 Unauthorized, 403 Forbidden, 404 Not Found</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>5xx</strong></td>
          <td style="text-align: left">伺服器錯誤 (Server Error)</td>
          <td style="text-align: left">500 Internal Server Error, 503 Service Unavailable</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="三主流-api-架構風格">三、主流 API 架構風格</h2>
<p>不同的應用場景催生了不同的 API 設計風格。</p>
<h3 id="1-rest-representational-state-transfer">1. REST (Representational State Transfer)</h3>
<p>REST 是目前 Web API 的主流設計風格，它不是一個嚴格的協議，而是一組設計原則。</p>
<ul>
<li><strong>核心思想</strong>：將所有事物都視為「資源」，並透過 URL 來定位。使用標準的 HTTP 方法 (<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>) 來操作這些資源。</li>
<li><strong>優點</strong>：簡單、直觀、易於理解，充分利用了 HTTP 協議的現有能力。</li>
<li><strong>缺點</strong>：
<ul>
<li><strong>Over-fetching</strong>：客戶端可能只需要部分資料，但 API 回傳了整個資源物件。</li>
<li><strong>Under-fetching</strong>：客戶端需要多個資源，必須發送多次請求 (<code>N+1 Problem</code>)。</li>
</ul>
</li>
</ul>
<h3 id="2-graphql-graph-query-language">2. GraphQL (Graph Query Language)</h3>
<p>由 Facebook 開發並開源，是一種為 API 設計的查詢語言。</p>
<ul>
<li><strong>核心思想</strong>：客戶端精確地定義自己需要的資料結構，伺服器則回傳不多不少的對應資料。</li>
<li><strong>優點</strong>：解決了 REST 的 Over-fetching 和 Under-fetching 問題，所有請求都透過單一 Endpoint (通常是 <code>/graphql</code>)，減少了網路請求次數。</li>
<li><strong>缺點</strong>：後端實作較為複雜，快取機制不如 REST 直觀。</li>
</ul>
<h3 id="3-grpc-google-remote-procedure-call">3. gRPC (Google Remote Procedure Call)</h3>
<p>由 Google 開發的高效能 RPC 框架。</p>
<ul>
<li><strong>核心思想</strong>：像呼叫本地函式一樣呼叫遠端伺服器的函式。</li>
<li><strong>技術特點</strong>：
<ul>
<li>使用 <strong>HTTP/2</strong> 進行傳輸，效能更高。</li>
<li>使用 <strong>Protocol Buffers (Protobuf)</strong> 作為資料序列化格式，它是一種二進位格式，比 JSON 更小更快。</li>
<li>強型別，透過 <code>.proto</code> 檔案定義服務介面，並能自動生成客戶端和伺服器端的程式碼。</li>
</ul>
</li>
<li><strong>適用場景</strong>：對效能要求極高的內部微服務間通訊。</li>
</ul>
<hr>
<h2 id="四api-安全性驗證與授權">四、API 安全性：驗證與授權</h2>
<p>保護 API 免於未經授權的存取至關重要。</p>
<ul>
<li><strong>API 金鑰 (API Keys)</strong>：最簡單的方式。客戶端在請求時帶上一個唯一的金鑰字串，伺服器驗證金鑰的有效性。適合公開但需要追蹤用量的 API。</li>
<li><strong>OAuth 2.0</strong>：一個行業標準的「授權」框架。它允許使用者授權第三方應用存取他們在另一服務上的資源，而無需分享密碼。你常見的「使用 Google / Facebook 登入」就是基於此框架。</li>
<li><strong>JWT (JSON Web Tokens)</strong>：一種緊湊且自包含的權杖格式。當使用者登入後，伺服器會簽發一個 JWT 給客戶端。客戶端在後續的每次請求中都會帶上這個 JWT，伺服器只需驗證 JWT 的簽名即可確認使用者身份和權限，無需頻繁查詢資料庫，非常適合無狀態 (Stateless) 的 RESTful API。</li>
</ul>
<hr>
<h2 id="五spring-boot-與-kotlin-實戰教學">五、Spring Boot 與 Kotlin 實戰教學</h2>
<p>我們將建構一個更完整的教學。</p>
<h3 id="準備工作建立專案">準備工作：建立專案</h3>
<p>前往 <strong>start.spring.io</strong>
設定專案：</p>
<ul>
<li><strong>Project</strong>: <code>Gradle - Kotlin</code></li>
<li><strong>Language</strong>: <code>Kotlin</code></li>
<li><strong>Spring Boot</strong>: 選擇一個穩定的版本 (如 <code>3.x.x</code>)</li>
<li><strong>Group, Artifact</strong>: 自訂您的專案名稱</li>
<li><strong>Dependencies</strong>: <code>Spring Web</code></li>
</ul>
<h3 id="part-1打造一個-restful-api-server-side">Part 1：打造一個 RESTful API (Server-Side)</h3>
<p>我們來建立一個簡單的 <strong>Task (待辦事項)</strong> 管理 API。</p>
<h4 id="1-資料模型與-dto">1. 資料模型與 DTO</h4>
<p>建立一個 Task 資料類別和對應的 DTO (Data Transfer Object)。使用 DTO 是個好習慣，可以讓 API 的介面與內部資料庫模型解耦。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// Task.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">java.util.UUID</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">data</span> <span style="color:#00f">class</span> <span style="color:#000">Task</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#00f">val</span> <span style="color:#000">id</span>: <span style="color:#000">String</span> = <span style="color:#000">UUID</span>.<span style="color:#000">randomUUID</span>().<span style="color:#000">toString</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#00f">var</span> <span style="color:#000">content</span>: <span style="color:#000">String</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#00f">var</span> <span style="color:#000">isDone</span>: <span style="color:#000">Boolean</span> = <span style="color:#00f">false</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic">// TaskDTO.kt - 用於新增與更新
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">data</span> <span style="color:#00f">class</span> <span style="color:#000">TaskDTO</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#00f">val</span> <span style="color:#000">content</span>: <span style="color:#000">String</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#00f">val</span> <span style="color:#000">isDone</span>: <span style="color:#000">Boolean</span>? = <span style="color:#00f">null</span> <span style="color:#888;font-style:italic">// 更新時可選
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>)
</span></span></code></pre></div><h4 id="2-建立-service-和-repository">2. 建立 Service 和 Repository</h4>
<p>為了簡單起見，我們用一個記憶體中的 <code>Map</code> 來模擬資料庫。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// TaskRepository.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.stereotype.Repository</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">java.util.concurrent.ConcurrentHashMap</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">@Repository</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#000">TaskRepository</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">private</span> <span style="color:#00f">val</span> <span style="color:#000">tasks</span> = <span style="color:#000">ConcurrentHashMap</span>&lt;<span style="color:#000">String</span>, <span style="color:#000">Task</span>&gt;()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">save</span>(<span style="color:#000">task</span>: <span style="color:#000">Task</span>): <span style="color:#000">Task</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000">tasks</span>[<span style="color:#000">task</span>.<span style="color:#000">id</span>] = <span style="color:#000">task</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">task</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">findById</span>(<span style="color:#000">id</span>: <span style="color:#000">String</span>): <span style="color:#000">Task</span>? = <span style="color:#000">tasks</span>[<span style="color:#000">id</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">findAll</span>(): <span style="color:#000">List</span>&lt;<span style="color:#000">Task</span>&gt; = <span style="color:#000">tasks</span>.<span style="color:#000">values</span>.<span style="color:#000">toList</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">deleteById</span>(<span style="color:#000">id</span>: <span style="color:#000">String</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#000">tasks</span>.<span style="color:#000">remove</span>(<span style="color:#000">id</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// TaskService.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.stereotype.Service</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#000">TaskService</span>(<span style="color:#00f">private</span> <span style="color:#00f">val</span> <span style="color:#000">taskRepository</span>: <span style="color:#000">TaskRepository</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">getAllTasks</span>(): <span style="color:#000">List</span>&lt;<span style="color:#000">Task</span>&gt; = <span style="color:#000">taskRepository</span>.<span style="color:#000">findAll</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">getTaskById</span>(<span style="color:#000">id</span>: <span style="color:#000">String</span>): <span style="color:#000">Task</span>? = <span style="color:#000">taskRepository</span>.<span style="color:#000">findById</span>(<span style="color:#000">id</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">createTask</span>(<span style="color:#000">dto</span>: <span style="color:#000">TaskDTO</span>): <span style="color:#000">Task</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">val</span> <span style="color:#000">task</span> = <span style="color:#000">Task</span>(<span style="color:#000">content</span> = <span style="color:#000">dto</span>.<span style="color:#000">content</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">taskRepository</span>.<span style="color:#000">save</span>(<span style="color:#000">task</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">updateTask</span>(<span style="color:#000">id</span>: <span style="color:#000">String</span>, <span style="color:#000">dto</span>: <span style="color:#000">TaskDTO</span>): <span style="color:#000">Task</span>? {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">val</span> <span style="color:#000">existingTask</span> = <span style="color:#000">taskRepository</span>.<span style="color:#000">findById</span>(<span style="color:#000">id</span>) ?: <span style="color:#00f">return</span> <span style="color:#00f">null</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">existingTask</span>.<span style="color:#000">content</span> = <span style="color:#000">dto</span>.<span style="color:#000">content</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">existingTask</span>.<span style="color:#000">isDone</span> = <span style="color:#000">dto</span>.<span style="color:#000">isDone</span> ?: <span style="color:#000">existingTask</span>.<span style="color:#000">isDone</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">taskRepository</span>.<span style="color:#000">save</span>(<span style="color:#000">existingTask</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">deleteTask</span>(<span style="color:#000">id</span>: <span style="color:#000">String</span>) = <span style="color:#000">taskRepository</span>.<span style="color:#000">deleteById</span>(<span style="color:#000">id</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="3-建立-controller">3. 建立 Controller</h4>
<p>控制器是 API 的入口，負責接收請求、呼叫服務並回傳回應。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// TaskController.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.http.HttpStatus</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.http.ResponseEntity</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.web.bind.annotation.*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#000">@RequestMapping</span>(<span style="color:#5a2">&#34;/api/v1/tasks&#34;</span>) <span style="color:#888;font-style:italic">// API 版本管理
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">class</span> <span style="color:#000">TaskController</span>(<span style="color:#00f">private</span> <span style="color:#00f">val</span> <span style="color:#000">taskService</span>: <span style="color:#000">TaskService</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@GetMapping</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">getAllTasks</span>(): <span style="color:#000">List</span>&lt;<span style="color:#000">Task</span>&gt; = <span style="color:#000">taskService</span>.<span style="color:#000">getAllTasks</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@GetMapping</span>(<span style="color:#5a2">&#34;/{id}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">getTaskById</span>(<span style="color:#000">@PathVariable</span> <span style="color:#000">id</span>: <span style="color:#000">String</span>): <span style="color:#000">ResponseEntity</span>&lt;<span style="color:#000">Task</span>&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">taskService</span>.<span style="color:#000">getTaskById</span>(<span style="color:#000">id</span>)
</span></span><span style="display:flex;"><span>            ?.<span style="color:#000">let</span> { <span style="color:#000">ResponseEntity</span>.<span style="color:#000">ok</span>(<span style="color:#00f">it</span>) } <span style="color:#888;font-style:italic">// if not null -&gt; 200 OK
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            ?: <span style="color:#000">ResponseEntity</span>.<span style="color:#000">notFound</span>().<span style="color:#000">build</span>() <span style="color:#888;font-style:italic">// if null -&gt; 404 Not Found
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@PostMapping</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@ResponseStatus</span>(<span style="color:#000">HttpStatus</span>.<span style="color:#000">CREATED</span>) <span style="color:#888;font-style:italic">// 回傳 201 Created
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>    <span style="color:#00f">fun</span> <span style="color:#000">createTask</span>(<span style="color:#000">@RequestBody</span> <span style="color:#000">taskDto</span>: <span style="color:#000">TaskDTO</span>): <span style="color:#000">Task</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">taskService</span>.<span style="color:#000">createTask</span>(<span style="color:#000">taskDto</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@PutMapping</span>(<span style="color:#5a2">&#34;/{id}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">updateTask</span>(<span style="color:#000">@PathVariable</span> <span style="color:#000">id</span>: <span style="color:#000">String</span>, <span style="color:#000">@RequestBody</span> <span style="color:#000">taskDto</span>: <span style="color:#000">TaskDTO</span>): <span style="color:#000">ResponseEntity</span>&lt;<span style="color:#000">Task</span>&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">taskService</span>.<span style="color:#000">updateTask</span>(<span style="color:#000">id</span>, <span style="color:#000">taskDto</span>)
</span></span><span style="display:flex;"><span>            ?.<span style="color:#000">let</span> { <span style="color:#000">ResponseEntity</span>.<span style="color:#000">ok</span>(<span style="color:#00f">it</span>) }
</span></span><span style="display:flex;"><span>            ?: <span style="color:#000">ResponseEntity</span>.<span style="color:#000">notFound</span>().<span style="color:#000">build</span>()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">@DeleteMapping</span>(<span style="color:#5a2">&#34;/{id}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#000">@ResponseStatus</span>(<span style="color:#000">HttpStatus</span>.<span style="color:#000">NO_CONTENT</span>) <span style="color:#888;font-style:italic">// 回傳 204 No Content
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>    <span style="color:#00f">fun</span> <span style="color:#000">deleteTask</span>(<span style="color:#000">@PathVariable</span> <span style="color:#000">id</span>: <span style="color:#000">String</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#000">taskService</span>.<span style="color:#000">deleteTask</span>(<span style="color:#000">id</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="part-2呼叫外部-api-client-side">Part 2：呼叫外部 API (Client-Side)</h3>
<p>Spring 推薦使用 <strong>WebClient</strong> 來取代傳統的 RestTemplate，因為 WebClient 是非阻塞、響應式的，更適合現代高效能應用。</p>
<h4 id="1-設定-webclient-bean">1. 設定 WebClient Bean</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// AppConfig.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.context.annotation.Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.context.annotation.Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.web.reactive.function.client.WebClient</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#000">AppConfig</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">webClient</span>(<span style="color:#000">builder</span>: <span style="color:#000">WebClient</span>.<span style="color:#000">Builder</span>): <span style="color:#000">WebClient</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#888;font-style:italic">// 可在此設定 Base URL, 預設 Headers 等
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>        <span style="color:#00f">return</span> <span style="color:#000">builder</span>
</span></span><span style="display:flex;"><span>            .<span style="color:#000">baseUrl</span>(<span style="color:#5a2">&#34;https://api.example.com&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#000">defaultHeader</span>(<span style="color:#5a2">&#34;Content-Type&#34;</span>, <span style="color:#5a2">&#34;application/json&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#000">build</span>()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="2-建立呼叫-api-的-service">2. 建立呼叫 API 的 Service</h4>
<p>這個 Service 將呼叫一個外部的用戶服務 API。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#888;font-style:italic">// ExternalApiService.kt
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.stereotype.Service</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">org.springframework.web.reactive.function.client.WebClient</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">reactor.core.publisher.Mono</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic">// 假設這是外部 API 的回應資料結構
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span><span style="color:#00f">data</span> <span style="color:#00f">class</span> <span style="color:#000">ExternalUserResponse</span>(<span style="color:#00f">val</span> <span style="color:#000">id</span>: <span style="color:#000">String</span>, <span style="color:#00f">val</span> <span style="color:#000">name</span>: <span style="color:#000">String</span>, <span style="color:#00f">val</span> <span style="color:#000">token</span>: <span style="color:#000">String</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#000">ExternalApiService</span>(<span style="color:#00f">private</span> <span style="color:#00f">val</span> <span style="color:#000">webClient</span>: <span style="color:#000">WebClient</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">fun</span> <span style="color:#000">updateUserToken</span>(<span style="color:#000">userId</span>: <span style="color:#000">String</span>, <span style="color:#000">projectId</span>: <span style="color:#000">String</span>?): <span style="color:#000">Mono</span>&lt;<span style="color:#000">ExternalUserResponse</span>&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">val</span> <span style="color:#000">endpoint</span> = <span style="color:#5a2">&#34;/api/user&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#888;font-style:italic">// 建立請求主體
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>        <span style="color:#00f">val</span> <span style="color:#000">requestBody</span> = <span style="color:#000">mapOf</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#5a2">&#34;user_id&#34;</span> <span style="color:#000">to</span> <span style="color:#000">userId</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#5a2">&#34;project_id&#34;</span> <span style="color:#000">to</span> <span style="color:#000">projectId</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> <span style="color:#000">webClient</span>
</span></span><span style="display:flex;"><span>            .<span style="color:#000">put</span>() <span style="color:#888;font-style:italic">// 使用 PUT 方法
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            .<span style="color:#000">uri</span>(<span style="color:#000">endpoint</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#000">header</span>(<span style="color:#5a2">&#34;admin-token&#34;</span>, <span style="color:#5a2">&#34;your_secret_admin_token&#34;</span>) <span style="color:#888;font-style:italic">// 設定特定請求的 Header
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            .<span style="color:#000">bodyValue</span>(<span style="color:#000">requestBody</span>) <span style="color:#888;font-style:italic">// 設定請求主體
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            .<span style="color:#000">retrieve</span>() <span style="color:#888;font-style:italic">// 發送請求並獲取回應
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            .<span style="color:#000">bodyToMono</span>(<span style="color:#000">ExternalUserResponse</span>::<span style="color:#00f">class</span>.<span style="color:#000">java</span>) <span style="color:#888;font-style:italic">// 將回應主體轉換為 Mono&lt;ExternalUserResponse&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>            .<span style="color:#000">doOnError</span> { <span style="color:#000">ex</span> -&gt;
</span></span><span style="display:flex;"><span>                <span style="color:#888;font-style:italic">// 在此處理錯誤，例如記錄日誌
</span></span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"></span>                <span style="color:#000">println</span>(<span style="color:#5a2">&#34;API call failed: </span><span style="color:#5a2">${ex.message}</span><span style="color:#5a2">&#34;</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="六api-設計最佳實務">六、API 設計最佳實務</h2>
<ul>
<li><strong>使用名詞而非動詞</strong>: <code>GET /api/tasks</code> 而不是 <code>GET /api/getAllTasks</code>。動詞應該由 HTTP Method 體現。</li>
<li><strong>版本管理</strong>: 在 URL 中加入版本號 (e.g., <code>/api/v1/tasks</code>) 是最清晰直接的方式。當您需要進行不向下相容的重大更新時，可以推出 <code>/v2</code>，而不會影響舊有客戶端。</li>
<li><strong>提供分頁 (Pagination)</strong>: 當資源列表過長時，應提供分頁功能，例如使用 <code>?page=1&amp;limit=20</code>。</li>
<li><strong>提供過濾、排序和欄位選擇</strong>: 讓客戶端能更靈活地獲取所需資料，例如 <code>GET /tasks?isDone=true&amp;sortBy=createdAt:desc</code>。</li>
<li><strong>提供有意義的錯誤訊息</strong>: 不要只回傳 <code>500 Internal Server Error</code>，而應該提供結構化的錯誤訊息，如 <code>{ &quot;error&quot;: &quot;InvalidInput&quot;, &quot;message&quot;: &quot;Email address is not valid&quot; }</code>。</li>
<li><strong>撰寫文件</strong>: API 的使用者是開發者。沒有文件的 API 等於不存在。使用 <strong>OpenAPI</strong> (以前的 Swagger) 標準來自動生成互動式 API 文件是現代開發的標配。</li>
</ul>
<hr>
<h2 id="結論">結論</h2>
<p>API 是串連起數位世界的橋樑，更是現代軟體架構的基石。從最初簡單的 RPC，到稱霸 Web 的 REST，再到為了應對新挑戰而生的 GraphQL 與 gRPC，API 的演進從未停止。掌握其核心概念、了解設計原則與安全機制，並能熟練地使用如 Spring Boot 等現代框架進行實踐，是每一位後端開發者不可或缺的核心技能。</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>


<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto text-center">
        <h2>Join Our Newsletter</h2>
        <p class="text-light px-md-5 py-4 border-left border-right border-primary">
          Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero</p>
        <form action="#" class="row justify-content-center">
          <div class="input-group col-md-8">
            <input type="text" class="form-control" placeholder="Your Email Address">
            <div class="input-group-append">
              <button class="input-group-text btn btn-primary">Subscribe</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>



<script>
  var indexURL = "http://localhost:1313/index.json"
</script>

<!-- JS Plugins -->

<script src="http://localhost:1313/plugins/jQuery/jquery.min.js"></script>

<script src="http://localhost:1313/plugins/bootstrap/bootstrap.min.js"></script>

<script src="http://localhost:1313/plugins/slick/slick.min.js"></script>

<script src="http://localhost:1313/plugins/venobox/venobox.min.js"></script>

<script src="http://localhost:1313/plugins/search/fuse.min.js"></script>

<script src="http://localhost:1313/plugins/search/mark.js"></script>

<script src="http://localhost:1313/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="http://localhost:1313/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>